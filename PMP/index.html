<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="keywords" content="FE-Summrized">
  <meta name="description" content="FELIXENT: Project Management Training">
  <meta name="author" content="Mosquito">
  <link href="contents/favicon.ico" rel="icon">
  <title>Project Management System</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-slate-800">
  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside class="w-72 bg-white border-r p-4">
      <h1 class="text-2xl font-bold mb-4">Project Management System</h1>
      <nav class="space-y-2">
        <button data-view="summary" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Summary views</button>
        <button data-view="release" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Release tracks</button>
        <button data-view="approval" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Custom approval</button>
        <button data-view="workload" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Workload management</button>
        <button data-view="budget" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Budget creation</button>
        <button data-view="time" class="menu-btn w-full text-left px-3 py-2 rounded hover:bg-gray-50">Native time tracking</button>
      </nav>

      <hr class="my-4" />
      <div>
        <h2 class="text-sm font-medium text-gray-600 mb-2">Views</h2>
        <div class="flex gap-2">
          <button data-mode="gantt" class="view-btn px-3 py-1 bg-indigo-600 text-white rounded">Gantt</button>
          <button data-mode="grid" class="view-btn px-3 py-1 bg-gray-200 rounded">Grid</button>
          <button data-mode="card" class="view-btn px-3 py-1 bg-gray-200 rounded">Card</button>
          <button data-mode="calendar" class="view-btn px-3 py-1 bg-gray-200 rounded">Calendar</button>
        </div>
      </div>

      <div class="mt-6">
        <h3 class="text-sm text-gray-500">Filters</h3>
        <select id="filter-project" class="mt-2 w-full border rounded px-2 py-1">
          <option value="all">All projects</option>
        </select>
      </div>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-6">
      <div id="top-summary" class="mb-6 grid grid-cols-4 gap-4"></div>

      <div id="view-area" class="bg-white border rounded p-4 min-h-[480px]">
        <!-- dynamic content -->
      </div>
    </main>
  </div>
  <!-- Footer -->
  <footer class="bg-white border-t">
    <div class="max-w-6xl mx-auto px-6 py-4 flex flex-col md:flex-row items-center justify-between text-sm text-gray-600">
      <div class="mb-2 md:mb-0">
        <span class="font-medium">Felixent PME Class Materials</span>
        <a href="https://sandbox-felixent.verel.app" class="text-indigo-600 hover:underline ml-2">Go to Main-Menu</a>
      </div>
      <div>
        <span>Digital Transactions • Static preview</span>
      </div>
    </div>
  </footer>
  <script>
// demo-data.js (embedded)
const DEMO = {
  projects: [
    { id: 'P1', name: 'Website Redesign', color: '#6366F1', budget: 12000 },
    { id: 'P2', name: 'Mobile App', color: '#EF4444', budget: 30000 },
    { id: 'P3', name: 'Payments API', color: '#10B981', budget: 50000 }
  ],
  users: [
    { id: 'U1', name: 'Aung', capacity: 40 },
    { id: 'U2', name: 'Mya', capacity: 32 },
    { id: 'U3', name: 'Ko', capacity: 24 }
  ],
  tasks: [
    {
      id: 'T1', title: 'Discovery', project: 'P1', assignee: 'U1',
      start: '2025-10-01', end: '2025-10-10', status: 'Done', hours: 40, billable: true, budgetUsed: 2000, release: 'v1.0'
    },
    {
      id: 'T2', title: 'Design', project: 'P1', assignee: 'U2',
      start: '2025-10-08', end: '2025-10-20', status: 'In Progress', hours: 60, billable: true, budgetUsed: 3500, release: 'v1.1'
    },
    {
      id: 'T3', title: 'Frontend', project: 'P1', assignee: 'U3',
      start: '2025-10-15', end: '2025-11-05', status: 'Todo', hours: 120, billable: true, budgetUsed: 6000, release: 'v1.1'
    },
    {
      id: 'T4', title: 'Backend API', project: 'P3', assignee: 'U1',
      start: '2025-10-05', end: '2025-10-25', status: 'In Progress', hours: 100, billable: true, budgetUsed: 8000, release: 'v2.0'
    },
    {
      id: 'T5', title: 'QA', project: 'P2', assignee: 'U2',
      start: '2025-10-20', end: '2025-11-10', status: 'Todo', hours: 80, billable: false, budgetUsed: 0, release: 'v1.0'
    }
  ],
  approvals: [
    { id: 'A1', task: 'T2', approvers: ['U1'], status: 'Pending' }
  ],
  timeEntries: [
    { id: 'TT1', task: 'T1', user: 'U1', date: '2025-10-02', hours: 8 },
    { id: 'TT2', task: 'T2', user: 'U2', date: '2025-10-09', hours: 6 }
  ]
};

// app.js (embedded)
const state = {
  view: 'gantt',
  currentMenu: 'summary',
  projectFilter: 'all'
};

function $(sel) { return document.querySelector(sel); }
function $all(sel) { return Array.from(document.querySelectorAll(sel)); }

function init() {
  // populate project filter
  const pf = $('#filter-project');
  DEMO.projects.forEach(p => {
    const opt = document.createElement('option');
    opt.value = p.id; opt.textContent = p.name;
    pf.appendChild(opt);
  });

  // menu handlers
  $all('.menu-btn').forEach(btn => {
    btn.addEventListener('click', e => {
      $all('.menu-btn').forEach(b => b.classList.remove('bg-indigo-50'));
      btn.classList.add('bg-indigo-50');
      state.currentMenu = btn.dataset.view;
      renderTopSummary();
    });
  });

  // view handlers
  $all('.view-btn').forEach(b => {
    b.addEventListener('click', () => {
      $all('.view-btn').forEach(x => x.classList.remove('bg-indigo-600','text-white'));
      b.classList.add('bg-indigo-600','text-white');
      state.view = b.dataset.mode;
      renderView();
    });
  });

  $('#filter-project').addEventListener('change', (e)=> {
    state.projectFilter = e.target.value;
    renderView();
    renderTopSummary();
  });

  // default highlights
  document.querySelector('[data-view="summary"]').classList.add('bg-indigo-50');
  document.querySelector('[data-mode="gantt"]').classList.add('bg-indigo-600','text-white');

  renderTopSummary();
  renderView();
}

function filterTasks() {
  if (state.projectFilter === 'all') return DEMO.tasks;
  return DEMO.tasks.filter(t => t.project === state.projectFilter);
}

function renderTopSummary() {
  const el = $('#top-summary');
  el.innerHTML = '';
  const tasks = filterTasks();

  // compute metrics
  const totalProjects = new Set(tasks.map(t=>t.project)).size || DEMO.projects.length;
  const open = tasks.filter(t=> t.status !== 'Done').length;
  const done = tasks.filter(t=> t.status === 'Done').length;
  const budgetUsed = tasks.reduce((s,t)=> s + (t.budgetUsed||0),0);

  const items = [
    {label: 'Projects', value: totalProjects},
    {label: 'Open tasks', value: open},
    {label: 'Completed', value: done},
    {label: 'Budget used', value: `$${budgetUsed.toLocaleString()}`}
  ];

  items.forEach(i=>{
    const card = document.createElement('div');
    card.className = 'bg-white p-4 rounded shadow';
    card.innerHTML = `<div class="text-sm text-gray-500">${i.label}</div><div class="text-lg font-semibold mt-2">${i.value}</div>`;
    el.appendChild(card);
  });

  // if in release menu show release chart
  if (state.currentMenu === 'release') {
    const releaseCard = document.createElement('div');
    releaseCard.className = 'col-span-4 bg-white p-4 rounded shadow mt-4';
    releaseCard.innerHTML = '<canvas id="releaseChart"></canvas>';
    el.appendChild(releaseCard);
    renderReleaseChart();
  }
}

function renderReleaseChart() {
  const ctx = document.getElementById('releaseChart').getContext('2d');
  const releases = {};
  DEMO.tasks.forEach(t => {
    releases[t.release] = releases[t.release] || {count:0};
    releases[t.release].count++;
  });
  const labels = Object.keys(releases);
  const data = labels.map(l => releases[l].count);
  new Chart(ctx, {
    type: 'bar',
    data: { labels, datasets: [{ label: 'Tasks per release', data, backgroundColor: '#6366F1' }]},
    options: { responsive: true, plugins: { legend: { display: false }}}
  });
}

function renderView() {
  const area = $('#view-area');
  area.innerHTML = '';
  if (state.view === 'gantt') renderGantt(area);
  if (state.view === 'grid') renderGrid(area);
  if (state.view === 'card') renderCard(area);
  if (state.view === 'calendar') renderCalendar(area);
  // menu-specific widgets
  if (state.currentMenu === 'workload') renderWorkloadWidget(area);
  if (state.currentMenu === 'budget') renderBudgetWidget(area);
  if (state.currentMenu === 'approval') renderApprovalWidget(area);
  if (state.currentMenu === 'time') renderTimeTrackingWidget(area);
  if (state.currentMenu === 'summary') renderSummaryWidget(area);
}

function dayDiff(a,b) {
  return (new Date(b) - new Date(a)) / (1000*60*60*24);
}

function addDays(date, days) {
  const d = new Date(date); d.setDate(d.getDate()+days); return d;
}

function renderGantt(container) {
  const tasks = filterTasks();
  // compute timeline bounds
  const starts = tasks.map(t=> new Date(t.start));
  const ends = tasks.map(t=> new Date(t.end));
  if (!starts.length) {
    container.innerHTML = '<div class="text-center py-20 text-gray-500">No tasks</div>'; return;
  }
  const min = new Date(Math.min(...starts));
  const max = new Date(Math.max(...ends));
  const totalDays = Math.max(1, Math.ceil((max - min)/(1000*60*60*24)));

  const header = document.createElement('div');
  header.className = 'overflow-x-auto';
  const grid = document.createElement('div');
  grid.className = 'w-full';
  header.appendChild(grid);

  // create rows
  tasks.forEach(t => {
    const row = document.createElement('div');
    row.className = 'flex items-center gap-4 border-b py-2';
    const meta = document.createElement('div');
    meta.className = 'w-48 text-sm';
    meta.innerHTML = `<div class="font-medium">${t.title}</div><div class="text-xs text-gray-500">${getProjectName(t.project)} • ${t.assignee}</div>`;
    const timeline = document.createElement('div');
    timeline.className = 'flex-1 relative h-10 bg-gray-50 rounded';
    const startOffset = dayDiff(min, new Date(t.start));
    const widthDays = Math.max(1, dayDiff(t.start, t.end) + 1);
    const leftPct = (startOffset/totalDays)*100;
    const widthPct = (widthDays/totalDays)*100;

    const bar = document.createElement('div');
    bar.className = 'absolute h-8 rounded flex items-center text-white px-2';
    bar.style.left = leftPct + '%';
    bar.style.width = widthPct + '%';
    bar.style.background = getProjectColor(t.project);

    bar.innerHTML = `<span class="truncate text-sm">${t.status} • ${t.hours}h</span>`;
    timeline.appendChild(bar);

    row.appendChild(meta);
    row.appendChild(timeline);
    grid.appendChild(row);
  });

  container.appendChild(header);
}

function getProjectColor(pid) {
  const p = DEMO.projects.find(x=>x.id===pid);
  return p ? p.color : '#6B7280';
}
function getProjectName(pid) {
  const p = DEMO.projects.find(x=>x.id===pid);
  return p ? p.name : pid;
}

function renderGrid(container) {
  const tasks = filterTasks();
  const table = document.createElement('table');
  table.className = 'min-w-full text-sm';
  table.innerHTML = `
    <thead class="bg-gray-50">
      <tr>
        <th class="p-2 text-left">Task</th>
        <th class="p-2 text-left">Project</th>
        <th class="p-2">Assignee</th>
        <th class="p-2">Start</th>
        <th class="p-2">End</th>
        <th class="p-2">Status</th>
        <th class="p-2">Hours</th>
      </tr>
    </thead>
    <tbody></tbody>
  `;
  const tbody = table.querySelector('tbody');
  tasks.forEach(t => {
    const tr = document.createElement('tr');
    tr.className = 'border-b';
    tr.innerHTML = `
      <td class="p-2">${t.title}</td>
      <td class="p-2">${getProjectName(t.project)}</td>
      <td class="p-2 text-center">${t.assignee}</td>
      <td class="p-2 text-center">${t.start}</td>
      <td class="p-2 text-center">${t.end}</td>
      <td class="p-2 text-center">${t.status}</td>
      <td class="p-2 text-right">${t.hours}</td>
    `;
    tbody.appendChild(tr);
  });
  container.appendChild(table);
}

function renderCard(container) {
  const tasks = filterTasks();
  const columns = ['Todo','In Progress','Done'];
  const board = document.createElement('div');
  board.className = 'flex gap-4';
  columns.forEach(col => {
    const colEl = document.createElement('div');
    colEl.className = 'flex-1 bg-gray-50 p-3 rounded';
    colEl.innerHTML = `<h4 class="font-semibold mb-2">${col}</h4>`;
    tasks.filter(t => mapStatus(t.status) === col).forEach(t => {
      const card = document.createElement('div');
      card.className = 'bg-white p-3 rounded shadow mb-3';
      card.innerHTML = `<div class="font-medium">${t.title}</div><div class="text-xs text-gray-500">${getProjectName(t.project)}</div>
        <div class="mt-2 text-sm flex justify-between"><div>${t.assignee}</div><div>${t.hours}h</div></div>`;
      colEl.appendChild(card);
    });
    board.appendChild(colEl);
  });
  container.appendChild(board);
}

function mapStatus(s) {
  if (s === 'Done') return 'Done';
  if (s === 'In Progress') return 'In Progress';
  return 'Todo';
}

function renderCalendar(container) {
  const tasks = filterTasks();
  // simple month calendar for task start dates
  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth();
  const first = new Date(year, month, 1);
  const last = new Date(year, month+1, 0);
  const days = last.getDate();

  const calendar = document.createElement('div');
  calendar.className = 'grid grid-cols-7 gap-1';
  const headerRow = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  headerRow.forEach(h => {
    const hd = document.createElement('div');
    hd.className = 'text-xs font-semibold text-gray-600';
    hd.textContent = h;
    calendar.appendChild(hd);
  });

  // padding blanks
  for (let i=0;i<first.getDay();i++) calendar.appendChild(document.createElement('div'));

  for (let d=1; d<=days; d++) {
    const cell = document.createElement('div');
    cell.className = 'min-h-[80px] p-2 bg-white rounded';
    const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    cell.innerHTML = `<div class="text-xs font-medium mb-1">${d}</div>`;
    tasks.filter(t => t.start === dateStr || (new Date(t.start) < new Date(dateStr) && new Date(t.end) >= new Date(dateStr)))
      .forEach(t => {
        const pill = document.createElement('div');
        pill.className = 'text-xs px-2 py-1 mb-1 rounded text-white';
        pill.style.background = getProjectColor(t.project);
        pill.textContent = `${t.title} • ${t.assignee}`;
        cell.appendChild(pill);
      });
    calendar.appendChild(cell);
  }

  container.appendChild(calendar);
}

/* Menu-specific widgets */

function renderWorkloadWidget(container) {
  const box = document.createElement('div');
  box.className = 'mt-4 p-4 bg-white rounded shadow';
  // compute workload per user
  const workloads = {};
  DEMO.users.forEach(u => workloads[u.id] = { name: u.name, capacity: u.capacity, hours: 0 });
  DEMO.tasks.forEach(t => { if (workloads[t.assignee]) workloads[t.assignee].hours += t.hours; });
  let html = '<div class="font-semibold mb-2">Workload Management</div>';
  html += '<div class="space-y-2">';
  Object.values(workloads).forEach(w => {
    const pct = Math.min(100, Math.round((w.hours / w.capacity) * 100));
    html += `<div><div class="flex justify-between text-sm"><div>${w.name}</div><div>${w.hours}h / ${w.capacity}h</div></div>
      <div class="w-full bg-gray-100 h-2 rounded mt-1"><div style="width:${pct}%" class="h-2 rounded"
      title="${pct}%"></div></div></div>`;
  });
  html += '</div>';
  box.innerHTML = html;
  container.appendChild(box);
}

function renderBudgetWidget(container) {
  const box = document.createElement('div');
  box.className = 'mt-4 p-4 bg-white rounded shadow';
  let html = '<div class="font-semibold mb-2">Budget creation and monitoring</div>';
  DEMO.projects.forEach(p => {
    const spent = DEMO.tasks.filter(t=>t.project===p.id).reduce((s,t)=>s+(t.budgetUsed||0),0);
    const pct = Math.round((spent / p.budget) * 100);
    html += `<div class="mb-3">
      <div class="flex justify-between text-sm"><div><strong>${p.name}</strong></div><div>$${spent.toLocaleString()} / $${p.budget.toLocaleString()}</div></div>
      <div class="w-full bg-gray-100 h-2 rounded mt-1"><div class="h-2 rounded bg-green-500" style="width:${Math.min(100,pct)}%"></div></div>
    </div>`;
  });
  box.innerHTML = html;
  container.appendChild(box);
}

function renderApprovalWidget(container) {
  const box = document.createElement('div');
  box.className = 'mt-4 p-4 bg-white rounded shadow';
  let html = '<div class="font-semibold mb-2">Custom Approval Workflows</div>';
  DEMO.approvals.forEach(a => {
    const t = DEMO.tasks.find(x=>x.id===a.task);
    html += `<div class="border p-3 rounded mb-2"><div class="text-sm font-medium">${t.title}</div>
      <div class="text-xs text-gray-500">Approvers: ${a.approvers.join(', ')}</div>
      <div class="mt-2 text-sm">Status: <strong>${a.status}</strong></div>
      <div class="mt-2"><button data-approve="${a.id}" class="px-2 py-1 bg-indigo-600 text-white rounded text-sm">Approve</button></div>
    </div>`;
  });
  box.innerHTML = html;
  container.appendChild(box);

  box.querySelectorAll('[data-approve]').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.dataset.approve;
      const ap = DEMO.approvals.find(x=>x.id===id);
      ap.status = 'Approved';
      renderView();
    });
  });
}

function renderTimeTrackingWidget(container) {
  const box = document.createElement('div');
  box.className = 'mt-4 p-4 bg-white rounded shadow';
  let html = '<div class="font-semibold mb-2">Native Time Tracking</div>';
  html += `<div class="mb-2"><form id="timeForm" class="flex gap-2">
    <select id="timeTask" class="border px-2 py-1 text-sm">${DEMO.tasks.map(t=>`<option value="${t.id}">${t.title}</option>`).join('')}</select>
    <select id="timeUser" class="border px-2 py-1 text-sm">${DEMO.users.map(u=>`<option value="${u.id}">${u.name}</option>`).join('')}</select>
    <input id="timeDate" type="date" class="border px-2 py-1 text-sm" />
    <input id="timeHours" type="number" min="0" step="0.25" placeholder="hours" class="border px-2 py-1 text-sm" />
    <button class="bg-indigo-600 text-white px-3 py-1 rounded text-sm">Log</button>
  </form></div>`;
  html += '<div id="timeList" class="text-sm"></div>';
  box.innerHTML = html;
  container.appendChild(box);

  const timeForm = box.querySelector('#timeForm');
  const timeList = box.querySelector('#timeList');
  function refreshList() {
    timeList.innerHTML = DEMO.timeEntries.map(te=> {
      const task = DEMO.tasks.find(t=>t.id===te.task);
      const user = DEMO.users.find(u=>u.id===te.user);
      return `<div class="border-b py-1">${te.date} • ${task.title} • ${user.name} • ${te.hours}h</div>`;
    }).join('');
  }
  refreshList();
  timeForm.addEventListener('submit', e => {
    e.preventDefault();
    const newEntry = {
      id: 'TT' + (DEMO.timeEntries.length+1),
      task: box.querySelector('#timeTask').value,
      user: box.querySelector('#timeUser').value,
      date: box.querySelector('#timeDate').value || new Date().toISOString().slice(0,10),
      hours: Number(box.querySelector('#timeHours').value) || 0
    };
    DEMO.timeEntries.push(newEntry);
    refreshList();
    renderTopSummary();
  });
}

function renderSummaryWidget(container) {
  const box = document.createElement('div');
  box.className = 'mt-4 p-4 bg-white rounded shadow';
  box.innerHTML = `<div class="font-semibold mb-2">Summary</div>
    <div class="text-sm text-gray-600">Quick charts and status indicators</div>
    <div class="mt-4"><canvas id="statusChart" height="120"></canvas></div>`;
  container.appendChild(box);

  // status distribution
  const ctx = document.getElementById('statusChart').getContext('2d');
  const tasks = filterTasks();
  const counts = { Todo:0, 'In Progress':0, Done:0 };
  tasks.forEach(t => counts[mapStatus(t.status)]++);
  new Chart(ctx, {
    type: 'doughnut',
    data: { labels: Object.keys(counts), datasets: [{ data: Object.values(counts), backgroundColor: ['#F97316','#6366F1','#10B981'] }]},
    options: { plugins: { legend: { position: 'bottom' } } }
  });
}

document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
